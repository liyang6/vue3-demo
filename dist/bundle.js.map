{"version":3,"file":"bundle.js","sources":["../src/shared/index.ts","../src/reactivity/effect.ts","../src/reactivity/baseHandlers.ts","../src/reactivity/reactive.ts"],"sourcesContent":["export const isObject = (val:unknown):val is Object => typeof val == 'object' && val !== null;","export const effect = (fn) => { \r\n  const effect = createReactiveEffect(fn);\r\n  effect();\r\n}\r\nexport let effectStack = []\r\nfunction createReactiveEffect(fn) { \r\n  const effect = function () { \r\n    effectStack.push(fn);\r\n    fn();\r\n  }\r\n\r\n  return effect;\r\n}","import { effectStack } from \"./effect\";\r\n\r\nexport const mutableHandlers = {\r\n  get(target, key, recevier) {  // 内置的 proxy中get和set参数是固定的\r\n\r\n    console.log('get')\r\n\r\n    return Reflect.get(target, key, recevier); // taget[key]\r\n  }, // 当取值的时候 应该将effect 存储起来\r\n  set(target, key, value, recevier) {\r\n\r\n      console.log('set')\r\n      let result = Reflect.set(target, key, value, recevier);\r\n      effectStack.forEach(effect=>effect());\r\n      return result\r\n  } // 当设置值的时候 应该通知对\r\n}","import { isObject } from \"../shared\"\nimport { mutableHandlers } from \"./baseHandlers\";\n\nexport const reactive = (target) => {\n    return createReactiveObject(target,mutableHandlers)\n}\n\nconst reactiveMap = new WeakMap();\n/* \nWeakMap\n  {\n  target:\n    {} ：new proxy(target)\n  }\n*/\nfunction createReactiveObject(target,baseHandler) { \n  if (!isObject(target)) { \n    return target\n  }\n\n  let existProxy = reactiveMap.get(target);\n  if (existProxy) { \n    return existProxy\n  }\n\n  const proxy = new Proxy(target, baseHandler);\n  reactiveMap.set(target, proxy);\n  return proxy;\n}\n"],"names":[],"mappings":";;;;;;EAAO,IAAM,QAAQ,GAAG,UAAC,GAAW,IAAmB,OAAA,OAAO,GAAG,IAAI,QAAQ,IAAI,GAAG,KAAK,IAAI,GAAA;;MCAhF,MAAM,GAAG,UAAC,EAAE;MACvB,IAAM,MAAM,GAAG,oBAAoB,CAAC,EAAE,CAAC,CAAC;MACxC,MAAM,EAAE,CAAC;EACX,EAAC;EACM,IAAI,WAAW,GAAG,EAAE,CAAA;EAC3B,SAAS,oBAAoB,CAAC,EAAE;MAC9B,IAAM,MAAM,GAAG;UACb,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;UACrB,EAAE,EAAE,CAAC;OACN,CAAA;MAED,OAAO,MAAM,CAAC;EAChB;;ECVO,IAAM,eAAe,GAAG;MAC7B,GAAG,YAAC,MAAM,EAAE,GAAG,EAAE,QAAQ;UAEvB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;UAElB,OAAO,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC;OAC3C;MACD,GAAG,YAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ;UAE5B,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;UAClB,IAAI,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;UACvD,WAAW,CAAC,OAAO,CAAC,UAAA,MAAM,IAAE,OAAA,MAAM,EAAE,GAAA,CAAC,CAAC;UACtC,OAAO,MAAM,CAAA;OAChB;GACF;;MCbY,QAAQ,GAAG,UAAC,MAAM;MAC3B,OAAO,oBAAoB,CAAC,MAAM,EAAC,eAAe,CAAC,CAAA;EACvD,EAAC;EAED,IAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAC;EAClC;;;;;;;EAOA,SAAS,oBAAoB,CAAC,MAAM,EAAC,WAAW;MAC9C,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;UACrB,OAAO,MAAM,CAAA;OACd;MAED,IAAI,UAAU,GAAG,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;MACzC,IAAI,UAAU,EAAE;UACd,OAAO,UAAU,CAAA;OAClB;MAED,IAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;MAC7C,WAAW,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;MAC/B,OAAO,KAAK,CAAC;EACf;;;;;;;;;;;"}